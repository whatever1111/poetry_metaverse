### 陆家花园项目发展路线图 (Roadmap) - 修订版

> **项目背景**：陆家花园诗歌元宇宙项目由诗人西尔（《毛小豆故事演绎》作者，也是诗人吴任几的朋友）发起，旨在通过数字技术重新诠释和体验诗歌。项目包含两个核心子项目：周与春秋练习项目（已发布v2.0.0）和毛小豆宇宙项目（开发中v3.0）。

> **开发者背景**：非专业开发者，从2025年7月26日开始学习编程，主要依赖Cursor AI辅助开发。项目采用严格的Git开发规范和AI协作指南。

#### **总览**

本项目的发展将分为三个核心阶段，**基于现有架构进行渐进式演进**，而非重新构建。目标是整合两个子项目的数据和服务，最终实现一个统一的诗歌元宇宙体验平台。

*   **第一阶段：数据整合与数据库化 (已完成)** - 让两个子项目"融合"。基于现有的Express.js后端，建立统一的数据库系统，将毛小豆宇宙的数据有机融入陆家花园主宇宙，实现数据的深度整合。
*   **第二阶段：统一后台与用户界面（已完成）** - 突出"统一"核心。开发统一的管理后台和用户界面，为后续的功能迭代和体验优化奠定坚实基础。
*   **第三阶段：功能深化与体验优化** - 让诗歌"立体"起来。在统一的架构上，逐步提升前端体验，并探索更丰富的诗歌互动形式。

---

## **第一阶段：数据整合与数据库化 (已完成)**

**目标**：基于现有的 `poeject_zhou_spring_autumn/application/server.js`，建立统一的数据库系统，将毛小豆宇宙的数据有机融入陆家花园主宇宙，实现两个子项目数据的深度整合。

### **子阶段划分**

#### **子阶段 A：数据库设计与数据建模** 
- **状态**: 已完成

**任务列表**:
- [x] 分析两个子项目的数据结构和关系
- [x] 设计统一的数据库表结构，体现"陆家花园主宇宙"概念
- [x] 建立数据关联关系（诗歌-角色-场景-主题的关联）
- [x] 安装和配置SQLite + Prisma环境

#### **子阶段 B：数据迁移与整合** 
- **状态**: 已完成

**任务列表**:
- [x] 编写数据迁移脚本，将JSON数据导入数据库
- [x] 建立毛小豆宇宙与周春秋项目的数据关联
- [x] 实现数据完整性验证和一致性检查
- [x] 创建数据统计和分析功能

#### **子阶段 C：统一API网关与数据服务** 
- **状态**: 已完成

**任务列表**:
- [x] 重构现有API，使用数据库替代JSON文件
- [x] 编写API自动化测试（使用Jest/Supertest），确保重构前后接口行为一致
- [x] 创建统一的API网关，支持跨项目数据访问
- [x] 实现数据查询和关联查询功能
- [x] 添加数据缓存和性能优化机制


### **第一阶段整体成果**
- 毛小豆宇宙数据成功融入陆家花园主宇宙
- 统一的数据库系统稳定运行
- 跨项目数据访问API完善
- 数据一致性和完整性得到保证

---

## **第二阶段：统一后台与用户界面（架构重构）（已完成）**

**目标**：基于“多宇宙”核心模型，重构管理后台与用户界面，实现真正的“统一管理、分别呈现”。**此阶段将纠正前期单体式开发的偏差，为项目长期、可扩展的发展奠定正确的架构基础。**

**完成时间**：2025-08-14  
**完成状态**：✅ 全部子阶段（A、B、C）已完成  
**验证结果**：21个端到端测试用例100%通过，系统稳定性验证完成

### **子阶段划分**

#### **子阶段 A：统一管理后台重构（以"宇宙"为核心）** ✅ 已完成
- **优先级**: P0
- **预计时长**: 8-12 天
- **实际完成时间**: 2025-08-14
- **关键风险**: 后端API重构、前端动态模块加载、数据模型交互
- **回滚方案**: 冻结此阶段的 `main` 分支，在独立 `feature/multi-universe-backend` 分支开发，在完成前不合并。
- **学习资源**: 模块化JavaScript、API设计模式、Prisma高级查询

**核心思想**: 从"管理内容"转变为"管理宇宙"，后台的一切操作都应以选择一个"宇宙"为起点。

**任务列表**:
- [x] **后台架构重设**: 设计一个以"宇宙仪表盘"为核心的后台主页，用于展示、创建和选择不同的宇宙 (`Universe`)。
- [x] **Admin API 重构**:
    - [x] 创建 `GET/POST/PUT/DELETE /api/admin/universes` 接口，用于增删改查 `Universe` 实体本身。
    - [x] 设计一套动态路由机制，能根据所选宇宙的 `type`，加载并委托给该宇宙专属的管理API模块。
- [x] **后台前端模块化**:
    - [x] 将现有 `admin.html` 的功能拆分为一个"周与春秋宇宙管理模块"。
    - [x] 当管理员在仪表盘选择"周与春秋"宇宙时，动态加载并显示此模块。
    - [x] 为"毛小豆宇宙"创建一个占位符模块，并设计其初步的管理界面（如角色、场景列表）。
- [x] **数据校验升级**: 将数据校验功能改造为可在"宇宙仪表盘"触发，可选择对特定宇宙或所有宇宙进行全局校验。

**退出条件**:
- [x] 管理员可以通过后台界面，完成对 `Universe` 表的增删改查。
- [x] 后台首页是一个"宇宙仪表盘"，清晰列出所有已创建的宇宙。
- [x] 点击"周与春秋"宇宙，能够加载并使用其专属的管理功能（即原有的后台功能）。
- [x] 为其他宇宙（如毛小豆）预留了清晰的管理模块扩展入口。

#### **子阶段 B：统一用户界面 (UI) 与公开 API 重构** ✅ 已完成
- **优先级**: P1
- **预计时长**: 7-10 天
- **实际完成时间**: 2025-08-14
- **关键风险**: UI/UX设计、公共API契约变更、前端数据获取逻辑重写
- **回滚方案**: 新UI与API部署在新的路由/域名下，旧版UI可作为临时回退选项。
- **学习资源**: UI/UX设计原则、前端路由、API版本管理

**核心思想**: 从"聚合展示"转变为"门户索引"，用户界面应首先作为一个清晰的门户，引导用户进入不同的、独立的宇宙体验。

**任务列表**:
- [x] **官网门户设计**: 将 `index.html` 重新设计为一个"陆家花园元宇宙"的门户页面，展示各个宇宙的入口，而非直接混合内容。
- [x] **Public API 重构**:
    - [x] 废弃 `/api/projects` 等扁平化接口，重构为宇宙中心的层级式接口，如：
        - `GET /api/universes`：获取所有公开可用的宇宙列表。
        - `GET /api/universes/:universeCode/content`：获取特定宇宙的核心内容（具体内容结构由该宇宙的 `type` 决定）。
    - [x] 为"周与春秋"宇宙编写新的内容获取API，并更新其前端页面 (`index.html` 的旧逻辑) 以消费新API。
- [x] **前端路由与组件化**:
    - [x] 设计简单的客户端路由或多页面策略，实现 `/` (门户) -> `/zhou` (周与春秋) -> `/maoxiaodou` (毛小豆) 的导航。
    - [x] 确保跨宇宙的通用组件（如顶栏、底栏）风格统一。

**退出条件**:
- [x] 网站主页成为一个清晰的"宇宙门户"。
- [x] 公开API以宇宙为中心进行重构，并有文档记录。
- [x] 用户可以从门户页导航至"周与春秋"宇宙，其功能与体验和重构前保持一致。

#### **子阶段 C：新架构集成与验证** ✅ 已完成
- **优先级**: P1
- **预计时长**: 4-6 天
- **实际完成时间**: 2025-08-14
- **关键风险**: 端到端流程的复杂性、API 契约固化、动态加载的稳定性
- **回滚方案**: 切换回子阶段 B 的稳定版本
- **学习资源**: Jest/Supertest for API testing, End-to-End testing concepts

**核心思想**: 验证 A、B 阶段重构的成果，确保新的"多宇宙"后台与"门户"前台架构稳定、可靠、可扩展，为第三阶段的功能开发扫清障碍。

**任务列表**:
- [x] **端到端流程验证**:
    - [x] 验证管理员工作流：登录 -> 宇宙仪表盘 -> 创建/编辑宇宙 -> 进入特定宇宙的管理模块。
    - [x] 验证用户工作流：访问门户 -> 浏览宇宙列表 -> 进入特定宇宙体验。
- [x] **新 API 契约测试**: 为所有新增和重构的 API 端点（管理和公开）编写合同测试，确保其行为符合预期。
- [x] **文档完善**: 更新 `documentation/backend/api-contracts.md`，使其完全反映新的、以宇宙为中心的 API 结构。
- [x] **系统稳定性测试**: 对动态模块加载、错误处理、边界条件（如空宇宙、未知宇宙类型）进行测试。

**退出条件**:
- [x] 新架构下的前后端功能完整对接，核心工作流无阻塞。
- [x] 关键 API 都有自动化测试覆盖，且文档清晰、同步。
- [x] "周与春秋"宇宙在新的架构内功能稳定，与重构前体验一致，证明新架构的向后兼容能力。

### **第二阶段整体退出条件**
- [x] 统一的管理后台和用户界面开发完成
- [x] 系统实现了统一的入口和管理模式
- [x] 为第三阶段的功能深化和体验优化奠定基础

---

## **第三阶段：功能深化与体验优化**

**目标**：在统一的架构基础上，渐进式地丰富功能、提升体验，让诗歌元宇宙更加"立体"和"鲜活"。

### **子阶段划分**

#### **子阶段 A：UI体验打磨与响应式适配**
- **优先级**: P0
- **预计时长**: 5-7 天
- **关键风险**: DOM操作、响应式设计
- **回滚方案**: 保持第二阶段的UI版本
- **学习资源**: JavaScript DOM操作、CSS响应式设计

**任务列表**:
- [ ] 优化统一UI的样式和布局，实现移动端响应式设计
- [ ] 使用原生JavaScript增强交互功能，提升流畅度
- [ ] 添加页面间平滑过渡效果

**退出条件**:
- 界面美观易用，移动端显示正常
- 用户交互体验明显提升

#### **子阶段 B：诗歌互动体验**
- **优先级**: P1
- **预计时长**: 6-8 天
- **关键风险**: 交互设计、用户体验
- **回滚方案**: 禁用新增的互动功能
- **学习资源**: 用户体验设计、交互设计

**任务列表**:
- [ ] 设计诗歌朗读功能
- [ ] 实现基于内容关联的诗歌推荐
- [ ] 创建诗歌创作引导或主题挑战功能
- [ ] 添加用户反馈机制

**退出条件**:
- 核心互动功能正常工作，体验流畅
- 功能符合诗歌项目定位

#### **子阶段 C：数据可视化**
- **优先级**: P1
- **预计时长**: 4-6 天
- **关键风险**: 可视化库使用、性能优化
- **回滚方案**: 切换回子阶段B的稳定版本
- **学习资源**: 数据可视化基础、图表库（如Chart.js）使用

**任务列表**:
- [ ] 在管理后台集成图表库
- [ ] 实现角色关系、诗歌主题分布、时间线等可视化图表
- [ ] 为高级分析API（如内容相似性、推荐）提供可视化结果展示

**退出条件**:
- 可视化功能正常工作，图表清晰
- 性能满足要求

### **第三阶段整体退出条件**
- 前端用户体验显著提升
- 诗歌互动体验丰富完整
- 核心数据实现可视化展示
- 项目具备更高层次的用户吸引力

---

## **未来展望**

此部分包含一些更长远的想法，可在核心功能稳定后进行探索。

#### **A：现代框架引入（可选）**
- **想法**: 评估是否需要引入Vue.js等现代前端框架，以应对更复杂的交互和状态管理。
- **前置条件**: 团队对原生JavaScript和组件化思想有深入理解。

#### **B：部署与运维优化**
- **想法**: 随着项目复杂度和用户量的增加，需要优化部署流程，并考虑更健壮的生产环境方案。
- **任务**:
  - [ ] 评估生产环境数据库方案（如PostgreSQL）
  - [ ] 添加监控和日志系统
  - [ ] 建立简单的CI/CD流程，实现自动化部署

---

## **项目整体里程碑**

### **里程碑 1：数据统一完成 (已达成)**
- **成果**: 两个子项目数据整合完成，统一API服务稳定运行，为后续开发奠定坚实基础。

### **里程碑 2：统一体验初步成型**（第二阶段完成后）
- 统一的管理后台和用户界面开发完成
- 实现统一的应用入口和管理模式
- 技术架构稳定可靠

### **里程碑 3：诗歌元宇宙体验完善**（第三阶段完成后）
- 功能丰富且特色鲜明
- 用户体验流畅、具有吸引力
- 具备持续发展和迭代的能力

---

## **学习支持与风险控制**

### **学习资源**
- **编程基础**: MDN Web Docs、JavaScript.info
- **框架学习**: Vue.js官方文档、Express.js指南
- **设计资源**: Bootstrap文档、CSS Grid/Flexbox教程
- **问题解决**: Stack Overflow、GitHub Issues

### **常见问题与解决方案**
- **API设计困惑**: 参考RESTful API设计原则
- **异步编程困难**: 从Promise开始，逐步学习async/await
- **样式调整复杂**: 使用浏览器开发者工具调试
- **部署问题**: 先确保本地运行正常，再考虑部署

### **风险控制**
- **版本控制**: 为主要阶段创建特性分支（如 `feature/phase-2`），将变更与主干隔离，确保主干始终稳定。
- **技术风险**: 每个阶段都有明确的回滚方案
- **学习风险**: 预留充足的学习时间，不急于求成
- **项目风险**: 保持现有功能的稳定性，渐进式改进

### **求助机制**
- **AI助手**: 充分利用Cursor AI的编程辅助功能
- **社区支持**: 在遇到问题时寻求技术社区帮助
- **文档记录**: 及时记录学习过程和解决方案

---

## **成功指标**

### **技术指标**
- API响应时间 < 1秒（考虑学习阶段）
- 前端页面加载时间 < 5秒
- 系统可用性 > 95%
- 代码可读性和维护性良好

### **用户体验指标**
- 界面美观且符合诗歌项目定位
- 交互流畅自然
- 功能完整且易用
- 移动端适配良好

### **学习指标**
- 掌握基础的编程概念
- 能够独立解决常见问题
- 建立良好的开发习惯
- 具备持续学习能力

### **项目指标**
- 按计划完成各阶段目标
- 保持项目架构的清晰性
- 文档完整且及时更新
- 代码质量达到可维护标准

---

*更新时间: 2025-08-12*  
*版本: 4.0*  
*项目: 陆家花园诗歌元宇宙*  
*开发者: 西尔（诗人，非专业开发者）*
