import { D as ref, E as unref, F as normalizeClass, G as normalizeStyle, H as toDisplayString, d as __plugin_vue_export_helper_default, i as withModifiers, j as Fragment, l as computed, m as createBaseVNode, n as createBlock, o as createCommentVNode, p as createElementBlock, q as createTextVNode, r as createVNode, s as defineComponent, v as openBlock, w as renderList, y as resolveDynamicComponent } from "./index-B1xTxyf1.js";
import { b as render$2 } from "./ArrowDownTrayIcon-WdJwsKtb.js";

//#region node_modules/@heroicons/vue/24/outline/esm/CheckIcon.js
function render$3(_ctx, _cache) {
	return openBlock(), createElementBlock("svg", {
		xmlns: "http://www.w3.org/2000/svg",
		fill: "none",
		viewBox: "0 0 24 24",
		"stroke-width": "1.5",
		stroke: "currentColor",
		"aria-hidden": "true",
		"data-slot": "icon"
	}, [createBaseVNode("path", {
		"stroke-linecap": "round",
		"stroke-linejoin": "round",
		d: "m4.5 12.75 6 6 9-13.5"
	})]);
}

//#endregion
//#region node_modules/@heroicons/vue/24/outline/esm/DocumentDuplicateIcon.js
function render(_ctx, _cache) {
	return openBlock(), createElementBlock("svg", {
		xmlns: "http://www.w3.org/2000/svg",
		fill: "none",
		viewBox: "0 0 24 24",
		"stroke-width": "1.5",
		stroke: "currentColor",
		"aria-hidden": "true",
		"data-slot": "icon"
	}, [createBaseVNode("path", {
		"stroke-linecap": "round",
		"stroke-linejoin": "round",
		d: "M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"
	})]);
}

//#endregion
//#region node_modules/@heroicons/vue/24/outline/esm/GlobeAltIcon.js
function render$4(_ctx, _cache) {
	return openBlock(), createElementBlock("svg", {
		xmlns: "http://www.w3.org/2000/svg",
		fill: "none",
		viewBox: "0 0 24 24",
		"stroke-width": "1.5",
		stroke: "currentColor",
		"aria-hidden": "true",
		"data-slot": "icon"
	}, [createBaseVNode("path", {
		"stroke-linecap": "round",
		"stroke-linejoin": "round",
		d: "M12 21a9.004 9.004 0 0 0 8.716-6.747M12 21a9.004 9.004 0 0 1-8.716-6.747M12 21c2.485 0 4.5-4.03 4.5-9S14.485 3 12 3m0 18c-2.485 0-4.5-4.03-4.5-9S9.515 3 12 3m0 0a8.997 8.997 0 0 1 7.843 4.582M12 3a8.997 8.997 0 0 0-7.843 4.582m15.686 0A11.953 11.953 0 0 1 12 10.5c-2.998 0-5.74-1.1-7.843-2.918m15.686 0A8.959 8.959 0 0 1 21 12c0 .778-.099 1.533-.284 2.253m0 0A17.919 17.919 0 0 1 12 16.5c-3.162 0-6.133-.815-8.716-2.247m0 0A9.015 9.015 0 0 1 3 12c0-1.605.42-3.113 1.157-4.418"
	})]);
}

//#endregion
//#region node_modules/@heroicons/vue/24/outline/esm/InformationCircleIcon.js
function render$5(_ctx, _cache) {
	return openBlock(), createElementBlock("svg", {
		xmlns: "http://www.w3.org/2000/svg",
		fill: "none",
		viewBox: "0 0 24 24",
		"stroke-width": "1.5",
		stroke: "currentColor",
		"aria-hidden": "true",
		"data-slot": "icon"
	}, [createBaseVNode("path", {
		"stroke-linecap": "round",
		"stroke-linejoin": "round",
		d: "m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"
	})]);
}

//#endregion
//#region node_modules/@heroicons/vue/24/outline/esm/ShareIcon.js
function render$1(_ctx, _cache) {
	return openBlock(), createElementBlock("svg", {
		xmlns: "http://www.w3.org/2000/svg",
		fill: "none",
		viewBox: "0 0 24 24",
		"stroke-width": "1.5",
		stroke: "currentColor",
		"aria-hidden": "true",
		"data-slot": "icon"
	}, [createBaseVNode("path", {
		"stroke-linecap": "round",
		"stroke-linejoin": "round",
		d: "M7.217 10.907a2.25 2.25 0 1 0 0 2.186m0-2.186c.18.324.283.696.283 1.093s-.103.77-.283 1.093m0-2.186 9.566-5.314m-9.566 7.5 9.566 5.314m0 0a2.25 2.25 0 1 0 3.935 2.186 2.25 2.25 0 0 0-3.935-2.186Zm0-12.814a2.25 2.25 0 1 0 3.933-2.185 2.25 2.25 0 0 0-3.933 2.185Z"
	})]);
}

//#endregion
//#region src/shared/components/ShareTools.vue?vue&type=script&setup=true&lang.ts
const _hoisted_1$1 = [
	"onClick",
	"disabled",
	"title"
];
var ShareTools_vue_vue_type_script_setup_true_lang_default = /* @__PURE__ */ defineComponent({
	__name: "ShareTools",
	props: {
		actions: {},
		showActions: {
			type: Boolean,
			default: true
		},
		animationDelay: { default: "0s" },
		layout: { default: "auto" }
	},
	setup(__props) {
		const props = __props;
		const visibleActions = computed(() => props.actions.filter((action) => action.visible !== false));
		const layoutClasses = computed(() => ({
			"flex-col items-stretch": props.layout === "vertical",
			"flex-row flex-wrap": props.layout === "horizontal"
		}));
		return (_ctx, _cache) => {
			return _ctx.showActions ? (openBlock(), createElementBlock("div", {
				key: 0,
				class: normalizeClass(["flex justify-center items-center gap-4 mt-8 pt-6 animate-fadeInUp max-md:gap-2 max-md:pt-4 max-sm:gap-3 max-sm:justify-center", layoutClasses.value]),
				style: normalizeStyle({ animationDelay: _ctx.animationDelay })
			}, [(openBlock(true), createElementBlock(Fragment, null, renderList(visibleActions.value, (action) => {
				return openBlock(), createElementBlock("button", {
					key: action.key,
					onClick: action.handler,
					class: normalizeClass([
						"btn-share-tools",
						action.variant && `btn-share-tools-${action.variant}`,
						action.additionalClasses,
						"max-sm:w-8 max-sm:h-8",
						props.layout === "vertical" && "w-8 h-8"
					]),
					disabled: action.disabled,
					title: action.title
				}, [(openBlock(), createBlock(resolveDynamicComponent(action.iconComponent), {
					class: "w-4 h-4",
					"aria-hidden": "true"
				}))], 10, _hoisted_1$1);
			}), 128))], 6)) : createCommentVNode("", true);
		};
	}
});

//#endregion
//#region src/modules/zhou/components/PoemViewer.vue?vue&type=script&setup=true&lang.ts
const _hoisted_1 = { class: "poem-viewer max-w-3xl mx-auto" };
const _hoisted_2 = { class: "text-display-spaced text-center relative inline-block w-full" };
const _hoisted_3 = {
	key: 0,
	class: "text-body-spaced text-center italic whitespace-pre-line max-w-[600px] mx-auto"
};
const _hoisted_4 = {
	key: 1,
	class: "text-caption-spaced text-right text-gray-600 font-medium max-w-[600px] mx-auto"
};
const _hoisted_5 = {
	key: 2,
	class: "text-body-spaced text-center font-semibold whitespace-pre-line max-w-[600px] mx-auto"
};
const _hoisted_6 = {
	key: 3,
	class: "text-body-spaced text-center whitespace-pre-line max-w-[600px] mx-auto"
};
const _hoisted_7 = {
	key: 4,
	class: "mt-xl pt-base border-t border-primary-200 flex justify-center items-center gap-sm"
};
const _hoisted_8 = { class: "text-caption text-gray-700 font-semibold" };
const _hoisted_9 = {
	key: 5,
	class: "text-caption-spaced text-center text-gray-600 italic"
};
const _hoisted_10 = { class: "bg-white rounded-lg shadow-2xl border border-gray-100 py-2 min-w-64 transform origin-top-right animate-fadeInUp" };
const _hoisted_11 = { class: "border-t border-gray-100 mt-1 pt-1" };
const _hoisted_12 = { class: "bg-white rounded-lg shadow-2xl border border-gray-100 py-3 px-4 max-w-xs w-full animate-fadeInUp" };
const _hoisted_13 = { class: "mt-3 pt-2 border-t border-gray-100" };
var PoemViewer_vue_vue_type_script_setup_true_lang_default = /* @__PURE__ */ defineComponent({
	__name: "PoemViewer",
	props: {
		poemTitle: { default: null },
		quoteText: { default: null },
		quoteCitation: { default: null },
		mainText: { default: null },
		poemBody: { default: null },
		author: { default: "" },
		additionalInfo: { default: "" },
		animationDelay: { default: "0s" },
		showActions: {
			type: Boolean,
			default: false
		},
		showDownload: {
			type: Boolean,
			default: false
		},
		showAiLabel: {
			type: Boolean,
			default: false
		}
	},
	emits: [
		"copied",
		"shared",
		"downloaded"
	],
	setup(__props, { emit: __emit }) {
		const props = __props;
		const emit = __emit;
		const isCopied = ref(false);
		const isActionLoading = ref(false);
		const showFallbackMenu = ref(false);
		const showAiInfo = ref(false);
		const menuPosition = computed(() => {
			const isMobile = window.innerWidth < 768;
			if (isMobile) return {
				bottom: "20%",
				left: "50%",
				right: "auto",
				transform: "translateX(-50%)",
				maxWidth: "calc(100vw - 2rem)"
			};
			else return {
				bottom: "15%",
				left: "50%",
				right: "auto",
				transform: "translateX(-50%)",
				maxWidth: "20rem"
			};
		});
		const cleanTitle = (title) => {
			if (!title) return "诗歌";
			return title.replace(/[《》]/g, "");
		};
		const formattedQuoteText = computed(() => props.quoteText ? enhanceTextFormatting(props.quoteText) : "");
		const formattedQuoteCitation = computed(() => {
			if (!props.quoteCitation) return "";
			return props.quoteCitation.replace(/^——/, "").trim();
		});
		const formattedMainText = computed(() => props.mainText ? enhanceTextFormatting(props.mainText) : "");
		const formattedLegacyBody = computed(() => {
			if (!props.poemBody) return "诗歌内容加载中...";
			if (typeof props.poemBody === "string") return enhanceTextFormatting(props.poemBody);
			return "不支持的诗歌格式";
		});
		const enhanceTextFormatting = (text) => {
			return text.replace(/\r\n?/g, "\n").replace(/\n{3,}/g, "\n\n").split("\n").map((line) => line.trimEnd()).join("\n").trim();
		};
		const plainTextContent = computed(() => {
			const title = cleanTitle(props.poemTitle);
			let content = "";
			if (props.quoteText || props.quoteCitation || props.mainText) {
				const parts = [];
				if (props.quoteText) parts.push(formattedQuoteText.value);
				if (props.quoteCitation) parts.push(`——${formattedQuoteCitation.value}`);
				if (props.mainText) parts.push(formattedMainText.value);
				content = parts.join("\n\n");
			} else if (props.poemBody) content = formattedLegacyBody.value;
			else content = "诗歌内容加载中...";
			const authorText = props.author ? `\n\n作者：${props.author}` : "";
			const infoText = props.additionalInfo ? `\n${props.additionalInfo}` : "";
			return `${title}\n\n${content}${authorText}${infoText}`;
		});
		const canShare = computed(() => {
			return typeof navigator !== "undefined" && "share" in navigator;
		});
		const actionButtons = computed(() => [
			{
				key: "copy",
				iconComponent: isCopied.value ? render$3 : render,
				handler: copyPoem,
				disabled: isActionLoading.value,
				title: isCopied.value ? "已复制" : "复制诗歌内容",
				variant: isCopied.value ? "success" : void 0,
				visible: true
			},
			{
				key: "share",
				iconComponent: render$1,
				handler: sharePoem,
				disabled: isActionLoading.value,
				title: "分享诗歌",
				visible: true
			},
			{
				key: "download",
				iconComponent: render$2,
				handler: downloadPoem,
				disabled: isActionLoading.value,
				title: "下载TXT文件",
				visible: props.showDownload
			}
		]);
		const copyPoem = async () => {
			if (isActionLoading.value) return;
			isActionLoading.value = true;
			try {
				const textToCopy = plainTextContent.value;
				if (navigator.clipboard && window.isSecureContext) await navigator.clipboard.writeText(textToCopy);
				else {
					const textArea = document.createElement("textarea");
					textArea.value = textToCopy;
					textArea.style.position = "fixed";
					textArea.style.left = "-9999px";
					textArea.style.opacity = "0";
					document.body.appendChild(textArea);
					textArea.focus();
					textArea.select();
					try {
						document.execCommand("copy");
					} catch {
						throw new Error("复制失败");
					} finally {
						document.body.removeChild(textArea);
					}
				}
				isCopied.value = true;
				emit("copied", textToCopy);
				setTimeout(() => {
					isCopied.value = false;
				}, 3e3);
			} catch (error) {
				console.error("复制诗歌失败:", error);
			} finally {
				isActionLoading.value = false;
			}
		};
		const getShareData = () => ({
			title: cleanTitle(props.poemTitle),
			text: plainTextContent.value,
			url: window.location.href
		});
		const getGeneralShareContent = (shareData) => {
			const author = props.author || "佚名";
			return `🌸 ${shareData.title} 🌸\n\n${shareData.text}\n\n————————————\n✍️ 作者：${author}\n📖 来源：陆家花园诗歌元宇宙\n🔗 ${shareData.url}\n\n#诗歌分享 #文学 #诗歌元宇宙`;
		};
		const getWeiboContent = (shareData) => {
			const weiboText = shareData.text.length > 100 ? shareData.text.substring(0, 100) + "..." : shareData.text;
			return `🌸 ${shareData.title} 🌸\n\n${weiboText}\n\n@陆家花园诗歌元宇宙 ${shareData.url}`;
		};
		const copyToClipboard = async (content) => {
			if (navigator.clipboard && window.isSecureContext) await navigator.clipboard.writeText(content);
			else {
				const textArea = document.createElement("textarea");
				textArea.value = content;
				document.body.appendChild(textArea);
				textArea.select();
				document.execCommand("copy");
				document.body.removeChild(textArea);
			}
		};
		const sharePoem = async () => {
			if (isActionLoading.value) return;
			isActionLoading.value = true;
			try {
				const shareData = getShareData();
				if (canShare.value) {
					await navigator.share(shareData);
					emit("shared", shareData);
				} else showFallbackMenu.value = true;
			} catch (error) {
				console.error("分享诗歌失败:", error);
				if (error instanceof Error && !error.message.includes("cancel")) showFallbackMenu.value = true;
			} finally {
				isActionLoading.value = false;
			}
		};
		const shareToWeibo = async () => {
			const shareData = getShareData();
			const content = getWeiboContent(shareData);
			try {
				const weiboUrl = `https://service.weibo.com/share/share.php?url=${encodeURIComponent(shareData.url || window.location.href)}&title=${encodeURIComponent(content)}`;
				window.open(weiboUrl, "_blank");
			} catch {
				await copyToClipboard(content);
			}
			showFallbackMenu.value = false;
			emit("shared", shareData);
		};
		const copyShareContent = async () => {
			const shareData = getShareData();
			const content = getGeneralShareContent(shareData);
			await copyToClipboard(content);
			showFallbackMenu.value = false;
			emit("shared", shareData);
		};
		const downloadPoem = () => {
			if (isActionLoading.value) return;
			isActionLoading.value = true;
			try {
				const content = plainTextContent.value;
				const title = cleanTitle(props.poemTitle);
				const fileName = `${title.replace(/[^\w\s-]/g, "")}.txt`;
				const blob = new Blob([content], { type: "text/plain;charset=utf-8" });
				const url = URL.createObjectURL(blob);
				const link = document.createElement("a");
				link.href = url;
				link.download = fileName;
				link.style.display = "none";
				document.body.appendChild(link);
				link.click();
				document.body.removeChild(link);
				setTimeout(() => {
					URL.revokeObjectURL(url);
				}, 100);
				emit("downloaded", fileName);
			} catch (error) {
				console.error("下载诗歌失败:", error);
			} finally {
				isActionLoading.value = false;
			}
		};
		return (_ctx, _cache) => {
			return openBlock(), createElementBlock("div", _hoisted_1, [createBaseVNode("div", {
				class: "poem-content unified-content-card card-padding-poem content-spacing-normal rounded-base animate-fadeInUp relative",
				style: normalizeStyle({ animationDelay: _ctx.animationDelay })
			}, [
				createBaseVNode("h2", _hoisted_2, [createTextVNode(toDisplayString(cleanTitle(_ctx.poemTitle)) + " ", 1), _ctx.showAiLabel ? (openBlock(), createElementBlock("button", {
					key: 0,
					onClick: _cache[0] || (_cache[0] = ($event) => showAiInfo.value = true),
					class: "ai-label-icon absolute",
					"aria-label": "AI生成内容说明",
					type: "button"
				}, [createVNode(unref(render$5), { class: "w-4 h-4" })])) : createCommentVNode("", true)]),
				_ctx.quoteText ? (openBlock(), createElementBlock("div", _hoisted_3, toDisplayString(formattedQuoteText.value), 1)) : createCommentVNode("", true),
				_ctx.quoteCitation ? (openBlock(), createElementBlock("div", _hoisted_4, " ——" + toDisplayString(formattedQuoteCitation.value), 1)) : createCommentVNode("", true),
				_ctx.mainText ? (openBlock(), createElementBlock("div", _hoisted_5, toDisplayString(formattedMainText.value), 1)) : createCommentVNode("", true),
				_ctx.poemBody && !_ctx.quoteText && !_ctx.mainText ? (openBlock(), createElementBlock("div", _hoisted_6, toDisplayString(formattedLegacyBody.value), 1)) : createCommentVNode("", true),
				_ctx.author ? (openBlock(), createElementBlock("div", _hoisted_7, [_cache[7] || (_cache[7] = createBaseVNode("span", { class: "text-caption text-gray-600 font-medium" }, "作者:", -1)), createBaseVNode("span", _hoisted_8, toDisplayString(_ctx.author), 1)])) : createCommentVNode("", true),
				_ctx.additionalInfo ? (openBlock(), createElementBlock("div", _hoisted_9, toDisplayString(_ctx.additionalInfo), 1)) : createCommentVNode("", true),
				createVNode(ShareTools_vue_vue_type_script_setup_true_lang_default, {
					actions: actionButtons.value,
					"show-actions": _ctx.showActions,
					"animation-delay": `${parseFloat(_ctx.animationDelay) + .3}s`,
					layout: "auto",
					class: normalizeClass(showFallbackMenu.value ? "share-tools-active" : "")
				}, null, 8, [
					"actions",
					"show-actions",
					"animation-delay",
					"class"
				]),
				showFallbackMenu.value ? (openBlock(), createElementBlock("div", {
					key: 6,
					class: "absolute inset-0 z-30 backdrop-blur-sm bg-black bg-opacity-10 rounded-base",
					onClick: _cache[3] || (_cache[3] = ($event) => showFallbackMenu.value = false)
				}, [createBaseVNode("div", {
					class: "absolute z-50",
					style: normalizeStyle(menuPosition.value),
					onClick: _cache[2] || (_cache[2] = withModifiers(() => {}, ["stop"]))
				}, [createBaseVNode("div", _hoisted_10, [
					_cache[10] || (_cache[10] = createBaseVNode("div", { class: "px-3 py-2 text-xs text-gray-500 border-b border-gray-100" }, " 选择分享平台 ", -1)),
					createBaseVNode("button", {
						onClick: shareToWeibo,
						class: "w-full flex items-center px-3 py-2.5 hover:bg-gray-50 transition-colors duration-200 text-left"
					}, [createVNode(unref(render$4), { class: "w-4 h-4 text-orange-500 mr-3" }), _cache[8] || (_cache[8] = createBaseVNode("div", { class: "flex-1" }, [createBaseVNode("div", { class: "text-sm font-medium" }, "微博"), createBaseVNode("div", { class: "text-xs text-gray-500" }, "打开分享页面")], -1))]),
					createBaseVNode("button", {
						onClick: copyShareContent,
						class: "w-full flex items-center px-3 py-2.5 hover:bg-gray-50 transition-colors duration-200 text-left"
					}, [createVNode(unref(render), { class: "w-4 h-4 text-blue-500 mr-3" }), _cache[9] || (_cache[9] = createBaseVNode("div", { class: "flex-1" }, [createBaseVNode("div", { class: "text-sm font-medium" }, "复制分享内容"), createBaseVNode("div", { class: "text-xs text-gray-500" }, "适用于微信/QQ/小红书等")], -1))]),
					createBaseVNode("div", _hoisted_11, [createBaseVNode("button", {
						onClick: _cache[1] || (_cache[1] = ($event) => showFallbackMenu.value = false),
						class: "w-full px-3 py-2 text-xs text-gray-500 hover:text-gray-700 transition-colors duration-200"
					}, " 取消 ")])
				])], 4)])) : createCommentVNode("", true),
				showAiInfo.value ? (openBlock(), createElementBlock("div", {
					key: 7,
					class: "absolute z-30 backdrop-blur-sm bg-black bg-opacity-10 rounded-base",
					style: {
						"top": "-64px",
						"left": "-24px",
						"right": "-24px",
						"bottom": "-24px"
					},
					onClick: _cache[6] || (_cache[6] = ($event) => showAiInfo.value = false)
				}, [createBaseVNode("div", {
					class: "ai-info-modal flex items-center justify-center h-full px-4",
					onClick: _cache[5] || (_cache[5] = withModifiers(() => {}, ["stop"]))
				}, [createBaseVNode("div", _hoisted_12, [
					_cache[11] || (_cache[11] = createBaseVNode("h4", { class: "text-sm font-bold mb-2 text-center" }, "注", -1)),
					_cache[12] || (_cache[12] = createBaseVNode("p", { class: "text-sm text-gray-700 leading-relaxed" }, " 该内容由陆家明创作。陆家明是一位AI诗人，同时也是陆家花园的主理人。 ", -1)),
					_cache[13] || (_cache[13] = createBaseVNode("p", { class: "text-sm text-gray-700 leading-relaxed mt-2" }, " 陆家明代表陆家花园承诺，不会保留您的任何个人隐私信息。 ", -1)),
					createBaseVNode("div", _hoisted_13, [createBaseVNode("button", {
						onClick: _cache[4] || (_cache[4] = ($event) => showAiInfo.value = false),
						class: "w-full py-2 text-xs text-gray-500 hover:text-gray-700 transition-colors duration-200"
					}, " 关闭 ")])
				])])])) : createCommentVNode("", true)
			], 4)]);
		};
	}
});

//#endregion
//#region src/modules/zhou/components/PoemViewer.vue
var PoemViewer_default = /* @__PURE__ */ __plugin_vue_export_helper_default(PoemViewer_vue_vue_type_script_setup_true_lang_default, [["__scopeId", "data-v-0e77c47f"]]);

//#endregion
export { PoemViewer_default as b, render$5 as c };